\documentclass[CJK, hyperref, oneside]{z-article}

\usepackage{import}

\usepackage[geometry, misc]{ifsym} % DiamondShadowC, Cube
\usepackage{manfnt}             % dbend
\usepackage{mathabx}            % boxplus
\usepackage{mathrsfs}           % mathscr
\usepackage{keystroke}          % keystroke
\usepackage{textcomp}           % textcurrency

\usepackage[top=1in, bottom=1in, left=1in, right=1in]{geometry}
\usepackage{pbox}
\usepackage{pdflscape}          % landscape
\usepackage{picture}

\usepackage{fancyhdr}
    \pagestyle{fancy}
    \fancyhf{}
    \renewcommand{\headrulewidth}{0pt}
    \fancyfoot[LO,RE]{}
    \fancyfoot[LE,RO]{\thepage}

\usepackage{fancybox}
\usepackage[vario]{fancyref}
\usepackage{url}
\usepackage{xstring}            % StrSubstritute, IfSubStr
\usepackage{enumitem}           % itemize
\usepackage{framed}

\usepackage{graphicx}           % includegraphics
\usepackage{z-quickz}

% \usepackage[table]{xcolor}
\usepackage{pgfplotstable}
    \pgfkeysifdefined{/pgfplots/table/output empty row/.@cmd}{
        % upcoming releases offer this more convenient option:
        \pgfplotstableset{
            empty header/.style={
              every head row/.style={output empty row},
            }
        }
    }{
        % versions up to and including 1.5.1 need this:
        \pgfplotstableset{  i
            empty header/.style={
                typeset cell/.append code={%
                    \ifnum\pgfplotstablerow=-1 %
                        \pgfkeyssetvalue{/pgfplots/table/@cell content}{}%
                    \fi
                }
            }
        }
    }
\usepackage{booktabs}           % toprule, bottomrule
\usepackage{longtable}          % Alt. to tabular, but not tabularx
\usepackage{multirow}           % Used by: history.tex, TX tables.
\usepackage{arydshln}           % hdashline

% Kill the unavailable in EU1 warnings.
\renewcommand\nobreakspace{}

\newcommand\button[1]{ \keystroke{#1} }
\newcommand\textbox[1]{ \ovalbox{#1} }

\newcommand\ol[1]{\begin{enumerate}{#1}\end{enumerate}}
\newcommand\ul[1]{\begin{itemize}{#1}\end{itemize}}

\newcommand\Fyes{$\bigcirc$}
\newcommand\Fno{$\times$}

\newcommand\itemtable[2]{{
    {
    %\centering
    \pgfplotstabletypeset[
        begin table=\begin{longtable},
        end table=\end{longtable},
        empty header,
        every first row/.append style={
            before row={
                \toprule
                id & 商品
                    & \multicolumn{2}{c}{数量} & 单位 & \multicolumn{2}{c}{单价} & \multicolumn{2}{c}{总额}
                    & 注释1 & 注释2 \\ \midrule
              \endfirsthead
                \multicolumn{11}{l}{（……续前）} \\ \hdashline
                id & 商品
                    & \multicolumn{2}{c}{数量} & 单位 & \multicolumn{2}{c}{单价} & \multicolumn{2}{c}{总额}
                    & 注释1 & 注释2 \\ \midrule
              \endhead
                \midrule \multicolumn{11}{r}{（参考后面继续……）} \\ \hdashline
              \endfoot
                \bottomrule
              \endlastfoot
            }},
        columns={ 0, 1, 2, 3, 4, 5, 6, 7 },
        columns/0/.style={ column name={id}, column type=c, verb string type },
        columns/1/.style={ column name={商品}, column type=p{2cm}, string type },
        columns/2/.style={ column name={数量}, column type=r, dec sep align },
        columns/3/.style={ column name={单位}, column type=c, verb string type },
        columns/4/.style={ column name={价格}, column type=r, precision=2, dec sep align },
        columns/5/.style={ column name={金额}, column type=r, precision=2, dec sep align },
        columns/6/.style={ column name={注释1}, column type=l, string type },
        columns/7/.style={ column name={注释2}, column type=l, string type },
        col sep=colon, header=false
    ]{\DIRNAME/a.tab}
    }
    \vskip 8mm
}}

\title {\modsubtitle}

\begin{document}

\renewcommand*\sectionmark[1]{\markright{\thesection. #1}}
%\renewcommand*\subsectionmark[1]{\markright{\thesubsection. #1}}
\renewcommand*\thesection{\arabic{section}}

\def\DIRNAME{.}

    %\begin{landscape}\mbox{}\vfill
    \itemtable{TITLE}{a.tab}
    %\vfill\mbox{}\end{landscape}
    
\end{document}
