<h:panelGroup xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core" xmlns:c="http://java.sun.com/jsp/jstl/core" xmlns:p="http://primefaces.org/ui">

    <c:set var="_var" value="${var != null ? var : 'chooseVerifyPolicyDialog'}" />
    <c:set var="_formName" value="${formName != null ? formName : 'chooseVerifyPolicyForm'}" />
    <c:set var="_multiple" value="${multiple != null ? multiple : false}" />
    <c:set var="_listener" value="${listener != null ? listener : chooseVerifyPolicyDialogBean}" />
    <c:set var="_update" value="${update != null ? update : viewConfig.defaultUpdateTarget}" />

    <p:dialog header="选择审核策略" widgetVar="${_var}" modal="true">
        <h:form id="${_formName}" style="max-height: 40em; margin: 1em">

            <p:fieldset legend="高级搜索" toggleable="true" collapsed="true">
                <h:panelGrid columns="3" columnClasses="">
                    <h:outputLabel for="pattern" value="名称:" />
                    <p:inputText id="pattern" value="${chooseVerifyPolicyDialogBean.labelPattern}" />
                    <p:commandButton value="添加" actionListener="${chooseVerifyPolicyDialogBean.addLabelRestriction}"
                        update="searchFragments, dataTable" async="true" />
                </h:panelGrid>
            </p:fieldset>

            <h:panelGroup id="searchFragments" style="display: block; padding: .2em 0em;">
                <ui:repeat id="repeat" var="fragment" value="${chooseVerifyPolicyDialogBean.searchFragments}">
                    <c:set var="form" value="${component.parent.parent.parent.clientId}" />
                    <p:commandButton value="${fragment.entryLabel}" async="true" actionListener="${fragment.detach}"
                        update="${form}:searchFragments, ${form}:dataTable" />
                </ui:repeat>
            </h:panelGroup>

            <p:dataTable id="dataTable" var="entry" value="${chooseVerifyPolicyDialogBean.dataModel}"
                selection="${chooseVerifyPolicyDialogBean.singleSelection}" selectionMode="single" paginator="true"
                rows="10" lazy="true" paginatorTemplate="${viewConfig.paginatorTemplate}" rowsPerPageTemplate="${viewConfig.pageSizeTemplate}"
                resizableColumns="true" scrollable="true" scrollHeight="350" scrollWidth="400" rowIndexVar="rowIndex">

                <p:column headerText="序号" style="width:1.5em;">
                    <h:outputText value="${rowIndex + 1}" />
                </p:column>

                <p:column headerText="名称">
                    <h:outputText value="#{entry.label}" />
                </p:column>

                <p:column headerText="描述">
                    <h:outputText value="#{entry.description}" />
                </p:column>

                <p:column headerText="创建日期">
                    <h:outputText value="#{entry.createdDate}">
                        <f:convertDateTime pattern="yyyy-MM-dd" timeZone="Asia/Shanghai" />
                    </h:outputText>
                </p:column>

                <p:column headerText="所有人">
                    <h:outputText value="#{entry.owner.displayName}" />
                </p:column>
            </p:dataTable>

            <div align="right">
                <p:commandButton oncomplete="${_var}.hide()" actionListener="${_listener.selected}"
                    update="${_update}" value="确定" async="true" />
                <p:commandButton value="关闭" oncomplete="${_var}.hide();" />
            </div>
        </h:form>
    </p:dialog>

</h:panelGroup>
