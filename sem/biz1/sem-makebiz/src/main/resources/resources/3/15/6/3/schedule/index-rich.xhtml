<ui:composition template="/template/custom-rich.xhtml" xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core" xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:p="http://primefaces.org/ui" xmlns:t="http://myfaces.apache.org/tomahawk" xmlns:fr="http://java.sun.com/jsf/composite/frame"
    xmlns:sem="http://java.sun.com/jsf/composite/3/15">

    <ui:param name="title" value="生产任务" />
    <ui:param name="bean" value="#{productionSchedule}" />

    <ui:define name="content">
        <div>
            <h:form id="mainForm">

                <t:div id="targetProject">
                    <p:fieldset legend="选择销售机会" toggleable="true" toggleSpeed="500">
                        <t:panelGrid columns="4">
                            <h:outputText value="选择需要查询的工程" />
                            <p:inputText value="${bean.project.subject}" id="selectedProject" />
                            <p:commandButton value="..." onclick="chooseChanceDialog.show();" />
                            <p:commandButton value="查看" actionListener="${bean.buildProjectTree}"
                                update=":mainForm:process_tree_view" />
                        </t:panelGrid>
                    </p:fieldset>
                </t:div>

                <t:div id="process_tree_view">
                    <p:fieldset legend="查看生产进度" toggleable="true" toggleSpeed="500" rendered="#{bean.project != null}">
                        <p:tree value="#{bean.root}" var="node" id="tree">
                            <p:treeNode id="treeNode">
                                <h:outputText value="#{node}" />
                            </p:treeNode>
                        </p:tree>
                    </p:fieldset>
                </t:div>
            </h:form>

            <sem:chooseChanceDialog id="chooseProjectDialog" target="${bean.project}" update=":mainForm:selectedProject" />
        </div>

    </ui:define>

</ui:composition>
