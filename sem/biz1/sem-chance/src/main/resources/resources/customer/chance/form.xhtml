<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
    xmlns:c="http://java.sun.com/jsp/jstl/core" xmlns:fmt="http://java.sun.com/jsp/jstl/fmt"
    xmlns:fn="http://java.sun.com/jsp/jstl/functions" xmlns:pc="http://bee32.com/plover/core"
    xmlns:sem="http://bee32.com/sem/functions">

<ui:composition template="/template/entity/form.xhtml">

    <ui:define name="styles.user">
        <!--  <link rel="stylesheet" type="text/css" href="form.css" />  -->
    </ui:define>

    <ui:define name="scripts.user">
        <script type="text/javascript" src="form.js"></script>
    </ui:define>

    <ui:define name="table">
        <table>
            <tr>
                <td>机会主题:</td>
                <td><input type="text" id="subject" name="subject" value="${it.subject}" /></td>
            </tr>
            <tr>
                <td>负责人:</td>
                <td><c:if test="${fn:length(it.owner.displayName) eq 0}">
                        <h:selectOneMenu id="ownerId">
                            <f:selectItem itemLabel="" itemValue="" />
                            <c:forEach var="owner" items="${owners}">
                                <f:selectItem itemLabel="${owner.name}" itemValue="${owner.id}" />
                            </c:forEach>
                        </h:selectOneMenu>
                    </c:if> <c:if test="${fn:length(it.owner.displayName) gt 0}">
                        <input type="text" id="owner" name="owner" value="${it.owner.displayName}" readonly="readonly"
                            maxlength="20" />
                        <input type="hidden" id="actorId" name="actorId" value="${it.owner.id}" />
                    </c:if></td>
            </tr>
            <tr>
                <td>机会分类:</td>
                <td><h:selectOneMenu id="category" value="it.category.name">
                        <f:selectItem itemLabel="" itemValue="" />
                        <c:forEach var="category" items="${categories}">
                            <f:selectItem itemLabel="${category.label}" itemValue="${category.name}" />
                        </c:forEach>
                    </h:selectOneMenu></td>
            </tr>
            <tr>
                <td>机会来源:</td>
                <td><h:selectOneMenu id="source" value="it.source.name">
                        <f:selectItem itemLabel="" itemValue="" />
                        <c:forEach var="source" items="${sources}">
                            <f:selectItem itemLabel="${source.label}" itemValue="${source.name}" />
                        </c:forEach>
                    </h:selectOneMenu></td>
            </tr>
            <tr>
                <td>机会内容:</td>
                <td><textarea id="content" name="content">${it.content}</textarea>
                </td>
            </tr>
            <tr>
                <td>发现时间:</td>
                <td><input type="text" id="createDate" name="createDate" value="${it.createDate}" />
                </td>
            </tr>
            <tr>
                <td>客户:</td>
                <td><c:forEach var="party" items="${it.parties}">
                        <a>${party.party.name}</a>
                    </c:forEach>
                </td>
            </tr>
            <tr>
                <td>行动记录:</td>
                <td>
                    <ul>
                        <c:forEach var="action" items="${it.actions}">
                            <c:if test="${fn:length(action.content) lt 16}">
                                <li>${action.content}</li>
                            </c:if>
                            <c:if test="${fn:length(action.content) gt 16}">
                                <li>${fn:substring(action.content, 0, 14)}..</li>
                            </c:if>
                        </c:forEach>
                    </ul></td>
            </tr>
        </table>

    </ui:define>

    <ui:define name="content.extra">
    </ui:define>

</ui:composition>
</html>