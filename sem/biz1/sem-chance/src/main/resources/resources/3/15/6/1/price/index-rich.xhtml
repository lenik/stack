<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
    xmlns:c="http://java.sun.com/jsp/jstl/core" xmlns:fmt="http://java.sun.com/jsp/jstl/fmt"
    xmlns:fn="http://java.sun.com/jsp/jstl/functions" xmlns:pc="http://bee32.com/plover/core"
    xmlns:sem="http://bee32.com/sem/functions" xmlns:p="http://primefaces.prime.com.tr/ui"
    xmlns:t="http://myfaces.apache.org/tomahawk">
<!-- InstanceBegin template="/Templates/seccaJsf.dwt.jsp" codeOutsideHTMLIsLocked="false" -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
</head>

<ui:composition template="/template/primefaces.xhtml">

    <ui:define name="title">基础价格管理</ui:define>

    <ui:define name="content">

        <h:outputStylesheet>
            .align_top {
                vertical-align:top;
            }
            .columnClass1{
                width:40%;
            }
            .columnClass2{
                width:60%;
            }
        </h:outputStylesheet>
        <h:form id="main">

            <p:growl id="growl" showDetail="true" />

            <p:dialog header="更新价格" widgetVar="updatePrice" modal="true" height="300" width="400">
                <t:panelGrid columns="2">
                    <h:outputLabel for="material" value="物料名称" />
                    <p:inputText id="material" value="#{basePriceBean.selectedMaterial}" readonly="#{true}" />

                    <h:outputLabel for="price" value="单价" />
                    <p:inputText id="price" value="#{basePriceBean.price}" />

                    <h:outputLabel for="remark" value="备注" />
                    <p:inputText id="remark" value="#{basePriceBean.remark}" />

                    <p:commandButton value="增加" actionListener="#{basePriceBean.addQuotationDetail}"
                        oncomplete="updatePrice.hide();" update="main:qdList" />
                    <p:commandButton value="取消" onclick="updatePrice.hide();" />
                </t:panelGrid>
            </p:dialog>

            <p:panel>

                <t:panelGrid columns="2" style="width:100%;" rowClasses="align_top"
                    columnClasses="columnClass1,columnClass2">
                    <p:panel header="物料列表" style="width:100%;">
                        <t:panelGroup colspan="2">
                            <p:inputText id="materialPattern" value="#{priceViewBean.materialPattern}" />
                            <p:commandButton value="查找物料" actionListener="#{basePriceBean.findMaterial}" ajax="true"
                                update="main:materialList" />
                        </t:panelGroup>
                        <p:dataTable id="materialList" var="item" value="#{basePriceBean.material}"
                            rowIndexVar="rowIndex">
                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="序号" />
                                </f:facet>
                                <h:outputText value="#{rowIndex + 1}" />
                            </p:column>
                            <p:column>
                                <f:facet name="header">
                            物料名称
                            </f:facet>
                                <h:outputText value="#{item}" />
                            </p:column>
                            <p:column>
                                <f:facet name="header">
                            操作
                            </f:facet>
                                <p:commandLink update="main:qdList,main:temp,main:material" title="察看价格"
                                    async="#{false}">
                                    <p:graphicImage value="#{location.ICON}/etool16/search.gif" />
                                    <f:setPropertyActionListener value="#{item}"
                                        target="#{basePriceBean.selectedMaterial}" />
                                </p:commandLink>
                            </p:column>
                        </p:dataTable>
                    </p:panel>

                    <p:panel header="历史价格表" style="width:100%;">
                        <p:toolbar id="temp">
                            <p:toolbarGroup align="left">

                                <h:outputText value="#{basePriceBean.selectedMaterial}" />

                                <p:commandButton value="更新价格" oncomplete="updatePrice.show()" />
                            </p:toolbarGroup>
                        </p:toolbar>
                        <p:dataTable id="qdList" var="basePrice" value="#{basePriceBean.basePriceList}">
                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="物料名称" />
                                </f:facet>
                                <h:outputText value="#{basePrice.material}" />
                            </p:column>
                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="时间" />
                                </f:facet>
                                <h:outputText value="#{basePrice.date}" />
                            </p:column>
                            <p:column>
                                <f:facet name="header">
                                    <h:outputText value="单价" />
                                </f:facet>
                                <h:outputText value="#{basePrice.price}" />
                            </p:column>
                            <p:column>
                                <f:facet name="header">
                                备注
                                </f:facet>
                                <h:outputText value="#{basePrice.remark}" />
                            </p:column>
                        </p:dataTable>
                    </p:panel>
                </t:panelGrid>
            </p:panel>


        </h:form>

    </ui:define>
</ui:composition>
</html>