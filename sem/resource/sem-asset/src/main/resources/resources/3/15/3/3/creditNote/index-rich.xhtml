<ui:composition template="/template/scroll-entity.xhtml" xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core" xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:p="http://primefaces.org/ui" xmlns:t="http://myfaces.apache.org/tomahawk"
    xmlns:sem="http://java.sun.com/jsf/composite/3/15">

    <ui:param name="title" value="收款单" />
    <ui:param name="bean" value="#{creditNoteAdminBean}" />
    <ui:param name="obj" value="#{bean.openedObject}" />
    <ui:param name="monetary" value="#{monetaryDictsBean}" />

    <ui:define name="editDialogContent">
        <p:panel header="收款单管理">
            <t:panelGrid id="info" columns="4">
                <h:outputText value="创建时间:" />
                <h:outputText value="#{obj.createdDate}">
                    <f:convertDateTime pattern="yyyy-MM-dd" timeZone="Asia/Shanghai" />
                </h:outputText>
                <h:outputText value="所有者:" />
                <p:inputText value="#{obj.owner.displayName}" readonly="true" style="width: 15em;" label="经办人"/>

                <h:outputText value="经办人:" />
                <t:panelGroup colspan="3">
                    <p:inputText id="operator" readonly="true" value="#{obj.operator.displayName}" label="经办人" />
                    <p:commandButton value="..." update=":choosePersonDialog:form" onclick="waitbox.show()"
                        oncomplete="waitbox.hide();choosePersonDialog.show()">
                        <f:setPropertyActionListener target="#{choosePersonDialogBean.employee}" value="true" />
                    </p:commandButton>
                </t:panelGroup>

                <h:outputText value="时间:" />
                <t:panelGroup colspan="3">
                    <p:calendar id="beginTime" label="时间" navigator="true" locale="zh_CN" pattern="yyyy-MM-dd"
                        value="#{obj.beginTime}" showOn="button" />
                </t:panelGroup>

                <h:outputText value="销售机会:" styleClass="e-link" onclick="#{obj.chance.clickAction}"/>
                <t:panelGroup colspan="3">
                    <p:inputText id="chance" label="销售机会" value="#{obj.chance.subject}" readonly="true" style="width:30em;"/>
                    <p:commandButton value="..." oncomplete="chooseChanceDialog.show()" disabled="#{not bean.editing}"/>
                </t:panelGroup>

                <h:outputText value="业务对象:" styleClass="e-link" onclick="#{obj.party.clickAction}"/>
                <t:panelGroup colspan="3">
                    <p:inputText id="party" label="业务对象" value="#{obj.party.displayName}" readonly="true" style="width:30em;"/>
                    <p:commandButton value="..." oncomplete="choosePartyDialog.show()" disabled="#{not bean.editing}"/>
                </t:panelGroup>

                <h:outputLabel value="金额:" />
                <p:inputText value="#{obj.value.value}" readonly="#{not bean.editing}" style="width: 15em;" label="金额"/>
                <h:outputLabel value="币种" />
                <p:selectOneMenu value="#{obj.value.currencyCode}" readonly="#{not bean.editing}" style="width: 15em;" label="币种">
                    <f:selectItem itemValue="" itemLabel="--选择币种--" />
                    <f:selectItems value="#{monetary.currencySelectItems}" />
                </p:selectOneMenu>

                <h:outputText value="摘要:" />
                <t:panelGroup colspan="3">
                    <p:inputText value="#{obj.description}" readonly="#{not bean.editing}" style="width: 35em" label="摘要"/>
                </t:panelGroup>

                <h:outputText value="业务详细:" />
                <t:panelGroup colspan="3">
                    <p:inputTextarea style="width: 35em; height: 15em;" value="#{obj.text}" readonly="#{not bean.editing}" label="业务详细"/>
                </t:panelGroup>
            </t:panelGrid>
        </p:panel>
    </ui:define>

    <ui:define name="dialogs">
        <sem:chooseChanceDialog id="c_chance" header="选择销售机会" target="#{obj.chance}" update=":editDialog:form:chance" />
        <sem:choosePartyDialog id="c_party" header="选择业务对象" target="#{obj.party}" update=":editDialog:form:party" />
        <sem:choosePersonDialog
            id="choosePersonDialog"
            var="choosePersonDialog"
            target="#{obj.operator}"
            update=":editDialog:form:operator" />
    </ui:define>
</ui:composition>
