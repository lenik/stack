<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
    xmlns:c="http://java.sun.com/jsp/jstl/core" xmlns:fmt="http://java.sun.com/jsp/jstl/fmt"
    xmlns:fn="http://java.sun.com/jsp/jstl/functions" xmlns:pc="http://bee32.com/plover/core"
    xmlns:sem="http://bee32.com/sem/functions" xmlns:p="http://primefaces.prime.com.tr/ui"
    xmlns:t="http://myfaces.apache.org/tomahawk">
<!-- InstanceBegin template="/Templates/seccaJsf.dwt.jsp" codeOutsideHTMLIsLocked="false" -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
</head>

<ui:composition template="/template/primefaces.xhtml">

    <ui:define name="title">material</ui:define>

    <ui:define name="content">

        <h:form id="note">
            <p:growl id="growl" showDetail="true" />
        </h:form>
        <h:form id="main">
            <p:tabView>
                <p:tab title="物料分类">
                    <p:toolbar>
                        <p:toolbarGroup>
                            <p:commandButton value="新增" title="新增分类"
                                actionListener="#{materialSettingsBean.createCategoryForm}"
                                onclick="categoryWizardDialog.show();" />
                            <p:commandButton id="editCategory" value="编辑" title="编辑分类"
                                actionListener="#{materialSettingsBean.editCategoryForm}"
                                update="dialogForm:newCategoryForm" oncomplete="categoryWizardDialog.show();" />
                            <p:commandButton id="deleteCategory" value="删除" title="删除分类"
                                actionListener="#{materialSettingsBean.destroyCategory}" update="main:mainTree,note" />
                        </p:toolbarGroup>
                    </p:toolbar>
                    <p:tree id="mainTree" value="#{materialSettingsBean.materialCategoryMainTree.rootNode}" var="node"
                        dynamic="true" selectionMode="single"
                        selection="#{materialSettingsBean.materialCategoryMainTree.selectedNode}">
                        <p:ajax event="select" listener="#{materialSettingsBean.onCategoryNodeSelect}"
                            update="main:categoryToolbar" />
                        <p:ajax event="unselect" listener="#{materialSettingsBean.onCategoryNodeUnselect}"
                            update="main:categoryToolbart" />
                        <p:treeNode>
                            <h:outputText value="#{node.name}" />
                        </p:treeNode>
                    </p:tree>
                </p:tab>
                <p:tab title="物料单位">
                    <p:toolbar>
                        <p:toolbarGroup>
                            <p:commandButton value="新增" title="新增单位" />
                            <p:commandButton id="deleteUnit" value="删除" title="新增单位" />
                        </p:toolbarGroup>
                    </p:toolbar>
                </p:tab>
                <p:tab title="单位换算表">
                    <p:toolbar>
                        <p:toolbarGroup>
                            <p:commandButton value="新增" title="新增单位换算表" />
                            <p:commandButton id="editUnitConv" value="编辑" title="编辑单位换算表" />
                            <p:commandButton id="deleteUnitConv" value="删除" title="删除单位换算表" />
                        </p:toolbarGroup>
                    </p:toolbar>
                </p:tab>
            </p:tabView>
        </h:form>

        <h:form id="dialogForm">
            <p:dialog header="物料分类" widgetVar="categoryWizardDialog" height="300" width="450" modal="true">
                <p:panel id="categoryForm">
                    <t:panelGrid columns="2">
                        <h:outputText value="上级本分" />
                        <t:panelGroup colspan="1">
                            <p:inputText value="#{materialSettingsBean.activeCategory.parent.name}" readonly="true" />
                            <p:commandButton value="..." title="选择上级分类" onclick="categorySelectDialog.show();" />
                        </t:panelGroup>

                        <h:outputText value="分类名称:" />
                        <p:inputText value="#{materialSettingsBean.activeCategory.name}" />

                        <p:commandButton value="确认" actionListener="#{materialSettingsBean.doSaveCategory}"
                            oncomplete="categoryWizardDialog.hide();" update="main:mainTree,note" />
                        <p:commandButton value="取消" onclick="categoryWizardDialog.hide();" />

                    </t:panelGrid>
                </p:panel>
            </p:dialog>

            <p:dialog header="选择上级分类" widgetVar="categorySelectDialog" height="500" width="700" modal="true">
                <p:tree value="#{materialSettingsBean.materialCategorySelectTree.rootNode}" var="node" dynamic="true"
                    selectionMode="single" selection="#{materialSettingsBean.materialCategorySelectTree.selectedNode}"
                    style="width:100%;">
                    <p:treeNode>
                        <h:outputText value="#{node.name}" />
                    </p:treeNode>
                </p:tree>
                <p:commandButton value="选择"
                    actionListener="#{materialSettingsBean.materialCategorySelectTree.onNodeSelect}"
                    update="dialogForm:categoryForm" oncomplete="categorySelectDialog.hide();" />
            </p:dialog>

        </h:form>

    </ui:define>
</ui:composition>
</html>