<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core" xmlns:p="http://primefaces.org/ui">
    <ui:param name="obj" value="${materialExAdminBean.activeObject}" />

    <p:dialog header="物料自定义属性" widgetVar="materialAttributeDialog" height="480" width="640" modal="true">
        <h:form id="materialAttributeForm">

            <h:outputText rendered="${obj != null}" value="当前物料: #{obj.label}" style="font-weight:bold;" />

            <p:separator style="width:600px;height:2px" />


            <p:commandButton value="增加自定义属性" update=":addMaterialAttributeForm" actionListener="#{materialExAdminBean.newMaterialAttribute}"
                onclick="addMaterialAttributeDialog.show()" />
            <p:dataTable id="attributes" value="#{materialExAdminBean.materialAttributes}" var="attr"
                resizableColumns="true" scrollable="true" scrollHeight="350" scrollWidth="400" rowIndexVar="rowIndex">

                <p:column headerText="序号" style="width:30px;">
                    <h:outputText value="#{rowIndex+1}" />
                </p:column>

                <p:column headerText="属性名称" style="width:100px;">
                    <h:outputText value="#{attr.name}" />
                </p:column>

                <p:column headerText="属性值" style="width:50px;">
                    <h:outputText value="#{attr.value}" />
                </p:column>

                <p:column headerText="操作" style="width:100px;">
                    <p:commandLink title="删除" oncomplete="deleteMaterialAttributeConfirmDialog.show()">
                        <f:setPropertyActionListener value="#{attr}"
                            target="#{materialExAdminBean.materialAttr}" />
                        <p:graphicImage value="#{location.ICON}/etool16/delete_edit.gif" />
                    </p:commandLink>
                </p:column>
            </p:dataTable>

        </h:form>
    </p:dialog>

    <p:dialog header="新增属性" widgetVar="addMaterialAttributeDialog" height="480" width="640" modal="true">
        <h:form id="addMaterialAttributeForm">
            <h:panelGrid id="addMaterialAttributePanel" columns="2">
                <h:outputText value="属性名称" />
                <p:inputText value="#{materialExAdminBean.materialAttr.name}" />

                <h:outputText value="属性值" />
                <p:inputText value="#{materialExAdminBean.materialAttr.value}" />

                <p:commandButton actionListener="#{materialExAdminBean.addMaterialAttribute}" update=":materialAttributeForm:attributes"
                    value="保存" oncomplete="addMaterialAttributeDialog.hide()" />
                <p:commandButton value="关闭" onclick="addMaterialAttributeDialog.hide()" />
            </h:panelGrid>
        </h:form>
    </p:dialog>

    <p:confirmDialog message="确定要删除吗?" width="200" header="删除确认" severity="alert"
        widgetVar="deleteMaterialAttributeConfirmDialog" modal="true">
        <h:form id="deleteMaterialAttributeConfirmForm">

            <p:commandButton value="确定" update=":materialAttributeForm:attributes" actionListener="#{materialExAdminBean.deleteMaterialAttribute}"
                oncomplete="deleteMaterialAttributeConfirmDialog.hide()" />
            <p:commandButton value="取消" onclick="deleteMaterialAttributeConfirmDialog.hide()" type="button" />

        </h:form>
    </p:confirmDialog>

</ui:composition>
