<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:fmt="http://java.sun.com/jsp/jstl/fmt"
      xmlns:fn="http://java.sun.com/jsp/jstl/functions"
      xmlns:pc="http://bee32.com/plover/core"
      xmlns:sem="http://bee32.com/sem/functions"
      xmlns:p="http://primefaces.prime.com.tr/ui"
      xmlns:t="http://myfaces.apache.org/tomahawk"
      >

<ui:composition template="/template/primefaces.xhtml">

    <ui:define name="title">修改密码</ui:define>

    <ui:define name="content">

        <h:outputStylesheet>
            .detail_col_title {
                width:150px;
                text-align: right;
            }

            .detail_col_value {
            }
        </h:outputStylesheet>

		<h:outputScript>
			function calcDigestOld() {
				var p = $.sha1($("#oldPassPlain").val());

				jQuery("#modifyPasswordForm\\:oldPass").val(p);
			}

            function calcDigestNew() {
                var p = $.sha1($("#newPassPlain").val());

                jQuery("#modifyPasswordForm\\:newPass").val(p);
            }

            function calcDigestConfirm() {
                var p = $.sha1($("#confirmPassPlain").val());

                jQuery("#modifyPasswordForm\\:confirmPass").val(p);
            }

		</h:outputScript>

		<h:form id="modifyPasswordForm">
            <p:panel header="用户注册">
                <h:panelGrid columns="2" columnClasses="detail_col_title, detail_col_value">

                    <h:outputLabel value="当前用户"/>
                    <h:outputText value="#{modifyPasswordBean.currentUser.displayName}"/>

                    <h:outputLabel for="oldPass" value="旧密码"/>
                    <t:panelGroup>
                        <input id="oldPassPlain" type="password" onchange="calcDigestOld();" />
                        <h:inputHidden id="oldPass" value="#{modifyPasswordBean.oldPass}" />
                    </t:panelGroup>

                    <h:outputLabel for="newPass" value="新密码"/>
                    <t:panelGroup>
                        <input id="newPassPlain" type="password" onchange="calcDigestNew();" />
                        <h:inputHidden id="newPass" value="#{modifyPasswordBean.newPass}" />
                    </t:panelGroup>

                    <h:outputLabel for="confirmPass" value="新密码确认"/>
                    <t:panelGroup>
                        <input id="confirmPassPlain" type="password" onchange="calcDigestConfirm();" />
                        <h:inputHidden id="confirmPass" value="#{modifyPasswordBean.confirmPass}" />
                    </t:panelGroup>


					<t:panelGroup colspan="2">
						<p:commandButton value="修改" update="modifyPasswordForm"
							actionListener="#{modifyPasswordBean.modify}" />
					</t:panelGroup>
				</h:panelGrid>

            </p:panel>
        </h:form>


    </ui:define>
</ui:composition>
</html>
