<ui:composition template="/template/simple-entity.xhtml" xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core" xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:p="http://primefaces.org/ui" xmlns:t="http://myfaces.apache.org/tomahawk">

    <ui:param name="title" value="公司/人员" />
    <ui:param name="bean" value="#{orgPersonAdminBean}" />
    <ui:param name="obj" value="#{bean.openedObject}" />
    <ui:param name="people" value="#{peopleDictsBean}" />

    <ui:define name="dataColumns">
        <p:column style="width:16px">
            <p:rowToggler />
        </p:column>

        <p:column headerText="公司名称">
            <h:outputText value="#{entry.label}" />
        </p:column>

        <p:column headerText="标签">
            <p:dataList value="#{entry.tags}" var="tag" type="definition">
                <f:facet name="description">
                    <h:outputText value="#{tag.label}" />
                </f:facet>
            </p:dataList>
        </p:column>

        <p:column headerText="联系电话">
            <h:outputText value="#{entry.contactsString}" />
        </p:column>

        <p:rowExpansion>
        <!--  dataTable doesn't render: PF-3.0.1, 3.1.RC1 -->
            <ui:repeat id="roles" var="role" value="#{entry.rolesList}">
                <h:panelGrid columns="4">
                    <h:outputText value="#{role.person.displayName}" />
                    <h:outputText value="#{role.role}" />
                    <h:outputText value="#{role.person.sexText}" />
                    <h:outputText value="#{role.person.contactsString}" />
                </h:panelGrid>
            </ui:repeat>
        </p:rowExpansion>
    </ui:define>

    <ui:define name="editDialogContent">
        <t:panelGrid id="editPanel" columns="4">
            <h:outputText value="公司名称" />
            <p:inputText value="#{bean.orgName}" />
            <h:outputText value="标签" />
            <p:selectManyCheckbox value="#{bean.selectedTags}">
                <f:selectItems value="#{people.partyTagnameSelectItems}" />
            </p:selectManyCheckbox>

            <h:outputText value="地址" />
            <t:panelGroup colspan="3">
                <p:inputText value="#{bean.orgAddress}" style="width:400px;" />
            </t:panelGroup>

            <h:outputText value="相关人员姓名" />
            <p:inputText value="#{bean.personName}" />
            <h:outputText value="性别" />
            <p:selectOneMenu id="personSex" value="#{bean.sex}" style="width:150px;">
                <f:selectItems value="#{bean.genders}" />
            </p:selectOneMenu>

            <h:outputText value="职务" />
            <t:panelGroup colspan="3">
                <p:inputText value="#{bean.personRole}" style="width:200px;" />
            </t:panelGroup>

            <h:outputText value="相关人员备注" />
            <t:panelGroup colspan="3">
                <p:inputText value="#{bean.personMemo}" style="width:400px;" />
            </t:panelGroup>

            <t:panelGroup colspan="4">
                <p:dataTable var="contact" value="#{bean.contactHolders}">
                    <p:column headerText="电话">
                        <p:inputText value="#{contact.tel}" />
                    </p:column>
                    <p:column headerText="手机">
                        <p:inputText value="#{contact.cellphone}" />
                    </p:column>
                    <p:column headerText="公司">
                        <p:selectBooleanCheckbox value="#{contact.org}" />
                    </p:column>
                    <p:column headerText="人员">
                        <p:selectBooleanCheckbox value="#{contact.person}" />
                    </p:column>
                </p:dataTable>
            </t:panelGroup>
        </t:panelGrid>
    </ui:define>
</ui:composition>
