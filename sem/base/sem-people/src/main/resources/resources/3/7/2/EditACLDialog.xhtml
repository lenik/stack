<h:panelGroup xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core" xmlns:c="http://java.sun.com/jsp/jstl/core" xmlns:p="http://primefaces.org/ui">

    <c:set var="_bean" value="${chooseACLDialogBean}" />
    <c:set var="_var" value="${var != null ? var : 'chooseACLDialog'}" />
    <c:set var="_caption" value="${caption != null ? caption : _bean.caption}" />
    <c:set var="_multiple" value="${multiple != null ? multiple : false}" />
    <c:set var="_listener" value="${listener != null ? listener : _bean}" />
    <c:set var="_update" value="${update != null ? update : viewConfig.defaultUpdateTarget}" />
    <p:dialog header="ACL 编辑" widgetVar="editDialog" modal="true">
        <c:set var="obj" value="#{bean.activeObject}" />
        <h:form id="editForm" style="max-height: 30em; margin: 1em">

            <t:panelGrid columns="2" columnClasses="detail_col_title,detail_col_value">

                <h:outputText value="名称" />
                <p:inputText value="#{obj.label}" />

                <h:outputText value="继承的ACL" />
                <h:panelGroup>
                    <p:inputText value="#{obj.inheritedACL.label}" readonly="true" />
                    <p:commandButton value="选择" />
                </h:panelGroup>

                <h:outputText value="描述" />
                <p:inputText value="#{obj.description}" size="50" />

            </t:panelGrid>

            <p:fieldset legend="列表项（ACE）" toggleable="false">
                <p:dataTable id="entryTable" value="#{obj.entries}" var="entry" resizableColumns="true"
                    rowIndexVar="rowIndex">
                    <p:column headerText="序号" style="width: 4em;">
                        <h:outputText value="#{rowIndex+1}" />
                    </p:column>

                    <p:column headerText="名称" style="width: 10em;">
                        <h:outputText value="#{entry.name}" />
                    </p:column>

                    <p:column headerText="类型" style="width: 5em;">
                        <h:outputText value="#{entry.typeName}" />
                    </p:column>

                    <p:column headerText="操作" style="width: 3em;">
                        <p:commandLink title="删除" action="#{bean.removeEntry}" update="editForm:entryTable">
                            <f:setPropertyActionListener value="#{entry}" target="#{bean.selectedEntry}" />
                            <p:graphicImage value="#{location.ICON}/etool16/delete_edit.gif" />
                        </p:commandLink>
                    </p:column>
                </p:dataTable>
                <p:commandButton value="增加责任对象" update="entryTable" onclick="addEntryDialog.show()" />
            </p:fieldset>

            <div align="right">
                <p:commandButton update="mainForm:dataTable" value="保存" actionListener="#{bean.save}"
                    oncomplete="editDialog.hide()" />
                <p:commandButton value="取消" onclick="editDialog.hide()" />
            </div>
        </h:form>
    </p:dialog>

</h:panelGroup>
