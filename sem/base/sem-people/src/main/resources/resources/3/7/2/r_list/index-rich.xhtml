<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:fmt="http://java.sun.com/jsp/jstl/fmt"
      xmlns:fn="http://java.sun.com/jsp/jstl/functions"
      xmlns:pc="http://bee32.com/plover/core"
      xmlns:sem="http://bee32.com/sem/functions"
      xmlns:p="http://primefaces.prime.com.tr/ui"
      xmlns:t="http://myfaces.apache.org/tomahawk"
      >
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
</head>

<ui:composition template="/template/primefaces.xhtml">

	<ui:define name="title">权限管理</ui:define>


	<ui:define name="content">

		<h:outputStylesheet>
            .align_top {
                vertical-align:top;
            }

            .col_left {
                width: 350px;
            }

            .table_inner_line {
                border: solid 1px #ccc;
                text-align: center;
            }
        </h:outputStylesheet>


		<h:form id="permissionForm">

			<p:panel header="权限管理">
				<p:toolbar id="permissionToolbar">
					<p:toolbarGroup align="left">

						<p:commandButton value="保存"
							actionListener="#{permissionAdminBean.doSave}"
							update="permissionForm:rpEntries"
							async="true" />
						<p:divider />

					</p:toolbarGroup>
				</p:toolbar>


				<t:panelGrid columns="2" rowClasses="align_top" columnClasses="col_left">
                    <p:panel header="权限主体列表">
					<p:tabView activeIndex="#{permissionAdminBean.activeTab}" style="width:100%;">

						<p:tab title="组列表">
							<p:dataTable id="groups" var="group"
								value="#{permissionAdminBean.groups}" resizableColumns="true"
								selection="#{permissionAdminBean.selectedGroup}"
								selectionMode="single"
                                    rowKey="#{group.id}" rowIndexVar="rowIndex">

								<p:ajax event="rowSelect"
									listener="#{permissionAdminBean.onRowSelectGroup}"
									update="permissionForm:rpEntries" />
								<p:ajax event="rowUnselect"
									listener="#{personAdminBean.onRowUnselectGroup}"
									update="permissionForm:rpEntries" />


								<p:column>
									<f:facet name="header">
										<h:outputText value="序号" />
									</f:facet>
									<h:outputText value="#{rowIndex + 1}" />
								</p:column>

								<p:column>
									<f:facet name="header">
										<h:outputText value="名称" />
									</f:facet>
									<h:outputText value="#{group.name}" />
								</p:column>

								<p:column>
                                        <f:facet name="header">
                                            <h:outputText value="全名" />
                                        </f:facet>
                                        <h:outputText value="#{group.fullName}" />
                                    </p:column>

							</p:dataTable>
						</p:tab>

						<p:tab title="角色列表">
							<p:dataTable id="roles" var="role"
								value="#{permissionAdminBean.roles}" resizableColumns="true"
								selection="#{permissionAdminBean.selectedRole}"
								selectionMode="single"
                                    rowKey="#{role.id}" rowIndexVar="rowIndex">

								<p:ajax event="rowSelect"
									listener="#{permissionAdminBean.onRowSelectRole}"
									update="permissionForm:rpEntries" />
								<p:ajax event="rowUnselect"
									listener="#{personAdminBean.onRowUnselectRole}"
									update="permissionForm:rpEntries" />


								<p:column>
									<f:facet name="header">
										<h:outputText value="序号" />
									</f:facet>
									<h:outputText value="#{rowIndex + 1}" />
								</p:column>

								<p:column>
									<f:facet name="header">
										<h:outputText value="名称" />
									</f:facet>
									<h:outputText value="#{role.name}" />
								</p:column>

								<p:column>
                                        <f:facet name="header">
                                            <h:outputText value="全名" />
                                        </f:facet>
                                        <h:outputText value="#{role.fullName}" />
                                    </p:column>

							</p:dataTable>

						</p:tab>

						<p:tab title="用户列表">
							<p:dataTable id="users" var="user"
								value="#{permissionAdminBean.users}" resizableColumns="true"
								selection="#{permissionAdminBean.selectedUser}"
								selectionMode="single"
                                    rowKey="#{user.id}" rowIndexVar="rowIndex">

								<p:ajax event="rowSelect"
									listener="#{permissionAdminBean.onRowSelectUser}"
									update="permissionForm:rpEntries" />
								<p:ajax event="rowUnselect"
									listener="#{personAdminBean.onRowUnselectUser}"
									update="permissionForm:rpEntries" />


								<p:column>
									<f:facet name="header">
										<h:outputText value="序号" />
									</f:facet>
									<h:outputText value="#{rowIndex + 1}" />
								</p:column>

								<p:column>
									<f:facet name="header">
										<h:outputText value="名称" />
									</f:facet>
									<h:outputText value="#{user.name}" />
								</p:column>

								<p:column>
                                        <f:facet name="header">
                                            <h:outputText value="全名" />
                                        </f:facet>
                                        <h:outputText value="#{user.fullName}" />
                                    </p:column>

							</p:dataTable>
						</p:tab>

					</p:tabView>
                    </p:panel>

					<p:panel header="权限列表" style="width:100%; margin-left:10px;">


						<t:panelGrid columns="7" style="border:solid 1px #ccc;"
							cellspacing="0" cellpading="0"
							columnClasses="table_inner_line,table_inner_line,table_inner_line,table_inner_line,table_inner_line,table_inner_line,table_inner_line">
							<h:outputText value="管理" />
							<h:outputText value="读取" />
							<h:outputText value="写入" />
							<h:outputText value="执行" />
							<h:outputText value="列表" />
							<h:outputText value="建立" />
							<h:outputText value="删除" />


							<t:panelGrid columns="3">
								<p:commandButton value="全"
									actionListener="#{permissionAdminBean.onSelectAllAdmin}"
									update="permissionForm:rpEntries"
									async="true" />
								<p:commandButton value="反"
									actionListener="#{permissionAdminBean.onSelectInvertAdmin}"
									update="permissionForm:rpEntries"
									async="true" />
								<p:commandButton value="不"
									actionListener="#{permissionAdminBean.onSelectNoneAdmin}"
									update="permissionForm:rpEntries"
									async="true" />
							</t:panelGrid>

							<t:panelGrid columns="3">
								<p:commandButton value="全"
									actionListener="#{permissionAdminBean.onSelectAllReadable}"
									update="permissionForm:rpEntries"
									async="true" />
								<p:commandButton value="反"
									actionListener="#{permissionAdminBean.onSelectInvertReadable}"
									update="permissionForm:rpEntries"
									async="true" />
								<p:commandButton value="不"
									actionListener="#{permissionAdminBean.onSelectNoneReadable}"
									update="permissionForm:rpEntries"
									async="true" />
							</t:panelGrid>

							<t:panelGrid columns="3">
								<p:commandButton value="全"
									actionListener="#{permissionAdminBean.onSelectAllWritable}"
									update="permissionForm:rpEntries"
									async="true" />
								<p:commandButton value="反"
									actionListener="#{permissionAdminBean.onSelectInvertWritable}"
									update="permissionForm:rpEntries"
									async="true" />
								<p:commandButton value="不"
									actionListener="#{permissionAdminBean.onSelectNoneWritable}"
									update="permissionForm:rpEntries"
									async="true" />
							</t:panelGrid>

							<t:panelGrid columns="3">
								<p:commandButton value="全"
									actionListener="#{permissionAdminBean.onSelectAllExecutable}"
									update="permissionForm:rpEntries"
									async="true" />
								<p:commandButton value="反"
									actionListener="#{permissionAdminBean.onSelectInvertExecutable}"
									update="permissionForm:rpEntries"
									async="true" />
								<p:commandButton value="不"
									actionListener="#{permissionAdminBean.onSelectNoneExecutable}"
									update="permissionForm:rpEntries"
									async="true" />
							</t:panelGrid>

							<t:panelGrid columns="3">
								<p:commandButton value="全"
									actionListener="#{permissionAdminBean.onSelectAllListable}"
									update="permissionForm:rpEntries"
									async="true" />
								<p:commandButton value="反"
									actionListener="#{permissionAdminBean.onSelectInvertListable}"
									update="permissionForm:rpEntries"
									async="true" />
								<p:commandButton value="不"
									actionListener="#{permissionAdminBean.onSelectNoneListable}"
									update="permissionForm:rpEntries"
									async="true" />
							</t:panelGrid>

							<t:panelGrid columns="3">
								<p:commandButton value="全"
									actionListener="#{permissionAdminBean.onSelectAllCreatable}"
									update="permissionForm:rpEntries"
									async="true" />
								<p:commandButton value="反"
									actionListener="#{permissionAdminBean.onSelectInvertCreatable}"
									update="permissionForm:rpEntries"
									async="true" />
								<p:commandButton value="不"
									actionListener="#{permissionAdminBean.onSelectNoneCreatable}"
									update="permissionForm:rpEntries"
									async="true" />
							</t:panelGrid>

							<t:panelGrid columns="3">
								<p:commandButton value="全"
									actionListener="#{permissionAdminBean.onSelectAllDeletable}"
									update="permissionForm:rpEntries"
									async="true" />
                                <p:commandButton value="反"
                                    actionListener="#{permissionAdminBean.onSelectInvertDeletable}"
                                    update="permissionForm:rpEntries"
                                    async="true" />
                                <p:commandButton value="不"
                                    actionListener="#{permissionAdminBean.onSelectNoneDeletable}"
                                    update="permissionForm:rpEntries"
                                    async="true" />
							</t:panelGrid>
						</t:panelGrid>



						<p:dataTable id="rpEntries" var="rpEntry"
							value="#{permissionAdminBean.rpEntries}" resizableColumns="true"
							selection="#{permissionAdminBean.selectedRpEntry}"
							selectionMode="single"
                            rowKey="#{rpEntry.key}" rowIndexVar="rowIndex">

							<p:columnGroup type="header">
								<p:row>
									<p:column rowspan="2" headerText="序号" />
									<p:column rowspan="2" colspan="2" headerText="权限资源" />
									<p:column colspan="7" headerText="权限" />
								</p:row>

								<p:row>
									<p:column headerText="管理" />
									<p:column headerText="读取" />
									<p:column headerText="写入" />
									<p:column headerText="执行" />
									<p:column headerText="列表" />
									<p:column headerText="建立" />
									<p:column headerText="删除" />
								</p:row>

							</p:columnGroup>


							<p:column>
								<h:outputText value="#{rowIndex + 1}" />
							</p:column>

							<p:column>
								<h:outputText value="#{rpEntry.resourceType}" />
							</p:column>

							<p:column>
								<h:outputText value="#{rpEntry.displayName}" />
							</p:column>

							<p:column>
								<p:selectBooleanCheckbox value="#{rpEntry.permission.admin}" />
							</p:column>

							<p:column>
								<p:selectBooleanCheckbox value="#{rpEntry.permission.readable}" />
							</p:column>

							<p:column>
								<p:selectBooleanCheckbox value="#{rpEntry.permission.writable}" />
							</p:column>

							<p:column>
								<p:selectBooleanCheckbox
									value="#{rpEntry.permission.executable}" />
							</p:column>

							<p:column>
								<p:selectBooleanCheckbox value="#{rpEntry.permission.listable}" />
							</p:column>

							<p:column>
								<p:selectBooleanCheckbox
									value="#{rpEntry.permission.creatable}" />
							</p:column>

							<p:column>
								<p:selectBooleanCheckbox
									value="#{rpEntry.permission.deletable}" />
							</p:column>


						</p:dataTable>


					</p:panel>
				</t:panelGrid>

			</p:panel>
		</h:form>

	</ui:define>
</ui:composition>
</html>
