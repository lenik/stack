<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
    xmlns:c="http://java.sun.com/jsp/jstl/core" xmlns:fmt="http://java.sun.com/jsp/jstl/fmt"
    xmlns:fn="http://java.sun.com/jsp/jstl/functions" xmlns:pc="http://bee32.com/plover/core"
    xmlns:sem="http://bee32.com/sem/functions" xmlns:p="http://primefaces.prime.com.tr/ui"
    xmlns:t="http://myfaces.apache.org/tomahawk">
<!-- InstanceBegin template="/Templates/seccaJsf.dwt.jsp" codeOutsideHTMLIsLocked="false" -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
</head>

<ui:composition template="/template/primefaces.xhtml">

    <ui:define name="title">userFileAdmin</ui:define>

    <ui:define name="content">

        <h:form id="note">
            <p:growl id="message" showDetail="true" />
        </h:form>

        <h:form id="main">
            <p:selectManyCheckbox id="checkbox_tagId" value="#{userFileAdmin.selectedTags}">
                <f:selectItem itemLabel="全部" itemValue="1" />
                <f:selectItems value="#{userFileAdmin.userFileTags}" />
                <p:ajax update="note:message" listener="#{userFileAdmin.addMessage}" />
            </p:selectManyCheckbox>
            <p:separator />
            <p:dataGrid id="fileGrid" value="#{userFileAdmin.userFileList}" var="file" columns="5" rows="12"
                paginator="true" effect="true" rowsPerPageTemplate="9,12,15"
                paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}">

                <p:column>
                    <p:panel header="#{file.fileName}">
                        <img src="#{file.imageHref}" height="36" width="36" border="0" />
                        <p:commandLink title="编辑" oncomplete="fileDialog.show();" update="main:fileDialogPanel">
                            <f:setPropertyActionListener value="#{file}" target="#{userFileAdmin.activeFile}" />
                            <p:graphicImage value="#{location.ICON}/etool16/editor_area.gif" />
                        </p:commandLink>
                    </p:panel>
                </p:column>

            </p:dataGrid>

            <p:dialog widgetVar="fileDialog" height="600" width="800">
                <p:panel id="fileDialogPanel">
                    <t:panelGrid columns="2">
                        <t:panelGroup colspan="2">
                            <img src="#{file.imageHref}" border="0" />
                        </t:panelGroup>

                        <h:outputText value="文件名:" />
                        <p:inputText value="#{userFileAdmin.activeFile.fileName}" />

                        <h:outputText value="文件标题:" />
                        <p:inputText value="#{userFileAdmin.activeFile.subject}" />

                        <h:outputText value="文件路径:" />
                        <p:inputText value="#{userFileAdmin.activeFile.origPath}" />

                    </t:panelGrid>

                </p:panel>
            </p:dialog>
        </h:form>

        <h:form enctype="multipart/form-data">

            <p:fileUpload fileUploadListener="#{userFileAdmin.handleFileUpload}" mode="advanced"
                update="note:message,main:fileGrid" multiple="true" allowTypes="png,gif,jpg,doc,docx,xsl,xslx" />

        </h:form>




    </ui:define>
</ui:composition>
</html>