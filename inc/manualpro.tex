\documentclass[hyperref, oneside]{book}

\usepackage{xunicode,xltxtra}
\usepackage{import}

\usepackage[slantfont,boldfont]{xeCJK}
\usepackage[geometry, misc]{ifsym} % DiamondShadowC, Cube
\usepackage{manfnt}             % dbend
\usepackage{mathabx}            % boxplus
\usepackage{mathrsfs}           % mathscr
\usepackage{keystroke}          % keystroke
\usepackage{textcomp}           % textcurrency
% \usepackage{MnSymbol}           % nequiv
\usepackage[cm-default]{fontspec}

\usepackage[top=1in, bottom=1in, left=1in, right=1in]{geometry}
\usepackage[pdfborder={0 0 0}]{hyperref}
\usepackage{pdflscape}          % landscape
% \usepackage{multicol}           % Multi column article

\usepackage{fancyhdr}
\usepackage{fancybox}
\usepackage[vario]{fancyref}
\usepackage{url}
\usepackage{xstring}            % StrSubstritute, IfSubStr
\usepackage{enumitem}           % itemize
% \usepackage{float}
\usepackage{framed}

\usepackage{graphicx}           % includegraphics
\usepackage{tikz}

% \usepackage[table]{xcolor}
\usepackage{pgfplotstable}
    \pgfkeysifdefined{/pgfplots/table/output empty row/.@cmd}{
        % upcoming releases offer this more convenient option:
        \pgfplotstableset{
            empty header/.style={
              every head row/.style={output empty row},
            }
        }
    }{
        % versions up to and including 1.5.1 need this:
        \pgfplotstableset{
            empty header/.style={
                typeset cell/.append code={%
                    \ifnum\pgfplotstablerow=-1 %
                        \pgfkeyssetvalue{/pgfplots/table/@cell content}{}%
                    \fi
                }
            }
        }
    }
\usepackage{booktabs}           % toprule, bottomrule
%\usepackage{tabularx}           % {X}
\usepackage{longtable}          % Alt. to tabular, but not tabularx
\usepackage{multirow}           % Used by: history.tex, TX tables.
\usepackage{arydshln}           % hdashline

% Kill the unavailable in EU1 warnings.
\renewcommand\nobreakspace{}

\setCJKmainfont{WenQuanYi Micro Hei}

\XeTeXlinebreaklocale "zh"
\XeTeXlinebreakskip = 0pt plus 1pt
\linespread{1.2}
\setlength{\columnsep}{.5in}

\newcommand*\ajax{AJAX}

\input{\DIRNAME/libmanual.tex}

\newcommand\modulechapter[2]{
    \chapter{#1}
    \def\DIRNAME{../../../#2/doc}
    \subimport{\DIRNAME/}{manual.tex}

    \section{扩展应用参考}

    \subsection{设计参数}
        \begin{landscape}
        \makefeaturetable{matrix.csv}
        \end{landscape}

    \subsection{数据依赖}
        （略）

    \subsection{数据交换格式}
        \begin{landscape}
        \input{\DIRNAME/TX-index}
        \end{landscape}
}

\title {\modtitle \\ \modsubtitle \\ 使用说明书}
\author{SECCA项目组 \\ $\infty$ \small{海宁市智恒软件有限公司}}

\begin{document}

\maketitle

\renewcommand\contentsname{目录/Contents}
\tableofcontents
\clearpage

\def\DIRNAME{.}
\import{\DIRNAME/}{profile}

\chapter{附录}

    \clearpage
    \subsection{版本历史}
        \begin{center}
        % \rowcolors{1}{white}{lightgray}
        \centering
        %\input{history}
        \end{center}

\chapter{索引}

    \listoftables
    \listoffigures

\end{document}
